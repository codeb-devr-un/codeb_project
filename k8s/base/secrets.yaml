# =============================================================================
# Secrets Template - Replace with actual values or use external secrets manager
# IMPORTANT: Never commit actual secrets to version control
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: codeb-secrets
  namespace: codeb
  labels:
    app.kubernetes.io/name: codeb
    app.kubernetes.io/component: secrets
type: Opaque
stringData:
  # Database - Primary (Write)
  database-url: "postgresql://codeb_app:${DB_PASSWORD}@pgbouncer:6432/codeb?schema=public&connection_limit=50"

  # Database - Read Replica
  database-url-read: "postgresql://codeb_readonly:${DB_READONLY_PASSWORD}@pgbouncer:6432/codeb_read?schema=public&connection_limit=100"

  # Redis Cluster
  redis-url: "redis://default:${REDIS_PASSWORD}@redis-cluster:6379"

  # NextAuth
  nextauth-secret: "${NEXTAUTH_SECRET}"

  # SendGrid
  sendgrid-api-key: "${SENDGRID_API_KEY}"

  # Google OAuth (optional)
  google-client-id: "${GOOGLE_CLIENT_ID}"
  google-client-secret: "${GOOGLE_CLIENT_SECRET}"

---
# =============================================================================
# PgBouncer Secrets
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: pgbouncer-secrets
  namespace: codeb
type: Opaque
stringData:
  userlist.txt: |
    "codeb_app" "${PGBOUNCER_APP_PASSWORD}"
    "codeb_readonly" "${PGBOUNCER_READONLY_PASSWORD}"
    "pgbouncer_admin" "${PGBOUNCER_ADMIN_PASSWORD}"

---
# =============================================================================
# External Secrets Operator Configuration (Recommended for Production)
# =============================================================================
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: codeb-external-secrets
#   namespace: codeb
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     kind: ClusterSecretStore
#     name: aws-secrets-manager
#   target:
#     name: codeb-secrets
#     creationPolicy: Owner
#   data:
#     - secretKey: database-url
#       remoteRef:
#         key: codeb/production/database
#         property: url
#     - secretKey: redis-url
#       remoteRef:
#         key: codeb/production/redis
#         property: url
#     - secretKey: nextauth-secret
#       remoteRef:
#         key: codeb/production/auth
#         property: secret
