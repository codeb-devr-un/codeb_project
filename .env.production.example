# =============================================================================
# CodeB CMS - Production Environment Variables
# Hyperscale Configuration for 100,000 Concurrent Users
# =============================================================================

# Application
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://codeb.app
NEXTAUTH_URL=https://codeb.app
NEXTAUTH_SECRET=your-production-secret-min-32-chars

# =============================================================================
# Database - Primary (Write Operations)
# =============================================================================
# Direct connection (for migrations only)
DATABASE_URL="postgresql://codeb_app:password@postgres-primary:5432/codeb?schema=public"

# PgBouncer connection (for application - transaction mode)
DATABASE_URL_POOLED="postgresql://codeb_app:password@pgbouncer:6432/codeb_primary?schema=public&connection_limit=50"

# =============================================================================
# Database - Read Replica
# =============================================================================
DATABASE_URL_READ="postgresql://codeb_readonly:password@pgbouncer:6432/codeb_read?schema=public&connection_limit=100"

# Enable read replica routing
USE_READ_REPLICA=true

# =============================================================================
# Redis Cluster
# =============================================================================
# Single node (development)
# REDIS_URL="redis://localhost:6379"

# Cluster mode (production)
REDIS_CLUSTER_ENABLED=true
REDIS_CLUSTER_NODES="redis-cluster-0:6379,redis-cluster-1:6379,redis-cluster-2:6379,redis-cluster-3:6379,redis-cluster-4:6379,redis-cluster-5:6379"
REDIS_PASSWORD=your-redis-password

# Cache settings
REDIS_CACHE_TTL_SHORT=60
REDIS_CACHE_TTL_MEDIUM=300
REDIS_CACHE_TTL_LONG=3600

# =============================================================================
# BullMQ Job Queue
# =============================================================================
BULLMQ_REDIS_HOST=redis-cluster
BULLMQ_REDIS_PORT=6379
BULLMQ_REDIS_PASSWORD=your-redis-password

# Worker concurrency settings
WORKER_EMAIL_CONCURRENCY=10
WORKER_NOTIFICATION_CONCURRENCY=50
WORKER_PAYROLL_CONCURRENCY=3
WORKER_REPORT_CONCURRENCY=2

# =============================================================================
# CDN Configuration
# =============================================================================
NEXT_PUBLIC_CDN_URL=https://cdn.codeb.app
NEXT_PUBLIC_IMAGE_CDN_URL=https://images.codeb.app

# Cloudflare settings (if using Cloudflare)
CLOUDFLARE_ZONE_ID=your-zone-id
CLOUDFLARE_API_TOKEN=your-api-token
CLOUDFLARE_ACCOUNT_ID=your-account-id

# =============================================================================
# Authentication - Google OAuth
# =============================================================================
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# =============================================================================
# Email - SendGrid
# =============================================================================
SENDGRID_API_KEY=SG.your-sendgrid-api-key
EMAIL_FROM=noreply@codeb.app
EMAIL_REPLY_TO=support@codeb.app

# =============================================================================
# Storage - S3 Compatible
# =============================================================================
S3_BUCKET=codeb-production
S3_REGION=ap-northeast-2
S3_ACCESS_KEY_ID=your-access-key
S3_SECRET_ACCESS_KEY=your-secret-key
S3_ENDPOINT=https://s3.ap-northeast-2.amazonaws.com

# =============================================================================
# Monitoring & Logging
# =============================================================================
LOG_LEVEL=warn
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project
SENTRY_ENVIRONMENT=production

# Prometheus metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# Security
# =============================================================================
# CORS origins (comma-separated)
CORS_ORIGINS=https://codeb.app,https://www.codeb.app

# CSP nonce (auto-generated per request recommended)
CSP_REPORT_URI=https://codeb.app/api/csp-report

# =============================================================================
# Feature Flags
# =============================================================================
FEATURE_READ_REPLICA=true
FEATURE_REDIS_CLUSTER=true
FEATURE_JOB_QUEUE=true
FEATURE_CDN_IMAGES=true
FEATURE_WEBSOCKETS=true

# =============================================================================
# Kubernetes/Container Settings
# =============================================================================
# Pod identification
POD_NAME=
POD_NAMESPACE=codeb
POD_IP=

# Health check endpoints
HEALTH_CHECK_PATH=/api/health
READY_CHECK_PATH=/api/health/ready

# Graceful shutdown timeout (seconds)
SHUTDOWN_TIMEOUT=30
